class site::nfs_server(
  Stdlib::AbsolutePath                             $data_dir     = '<%= nfs_static_data_dir %>',
  Simplib::Netlist                                 $trusted_nets = simplib::lookup('simp_options::trusted_nets', { 'default_value' => ['127.0.0.1'] }),
  Array[Enum['none','sys','krb5','krb5i','krb5p']] $sec          = ['sec']
){
  include nfs::server

  file { $data_dir:
    ensure => 'directory',
    owner  => 'root',
    group  => 'root',
    mode   => '0755'
  }

  nfs::server::export { 'nfs_share':
    clients     => $trusted_nets,
    export_path => $data_dir,
    sec         => $sec,
    require     => File[$data_dir]
  }
}
